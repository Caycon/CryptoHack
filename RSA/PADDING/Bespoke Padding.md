![image](https://hackmd.io/_uploads/HyXQTX8ZC.png)
- Ta hãy lưu ý hàm `pad`. Hàm `pad` tạo ra flag sau khi pad có dạng $a*m+b$.
```Python
def pad(self, flag):
    m = bytes_to_long(flag)
    a = random.randint(2, self.N)
    b = random.randint(2, self.N)
    return (a, b), a*m+b
```
- Nếu ta nhận $2c$ từ sever thì ta có tìm được flag dựa trên hàm pad bằng cách sau:
$$c_1= (a_1*m+ b_1)^e\ mod(n)$$ $$c_2= (a_2*m+ b_2)^e\ mod(n)$$
- Suy ra:
$$f_1 = (a_1 * x + b_1)^e -c_1= 0\ mod(n)$$ $$f_2 = (a_2 * x + b_2)^e -c_2= 0\ mod(n)$$
- Từ đây ta lấy GCD của $f_1, f_2$ ta sẽ thu được flag.
```Python
from Crypto.Util.number import *
e= 11

a_1= 6133949050067298652891732285984333303205886210575004621136848221222454831779179003828611829548864663815867688083465174208816477085582792026188922174233905828433287848668574845437461702664346937261585270626340172370780680003395792106649367480603907049240029161494435194360164757573384671538154469918106480070712691085237639934288182708107804530829289241733936248431993890629287273486150107897566379160112558305222611473065075096743008063283247415141512161829045242032212064229662894195804704297672964972529064417673809490268144760343544049618944111116634597194926940369629655119925307413185090097688170606958149354689
a_2= 7278785479563032076217372072478742163364049824278768817708658539903270801518023918779895024210989090568888582542582028348751831998235566278679075968947304679463797091642616235215918791594086892519762887573526177721228321027998145000676784949384486383189382747358758605172729318456799653632946876183374507963226949217817331545873550195930672166037942897507485968085193822595973021183244604458728496591545129243629668129874493063684878566877787164097805379016723297283531538348963053417588765471733847436676493331556656065503288601539158075473859738637224074087760270097903016780901069285201197512947712289007266196707
b_1= 9352131218175100321164720090910986400556184443794247937348484058659896415785140745758020988686002306831017115068548953239537917488841522253652922320320125123116273465716166431335982785772308121928197374194732384981297361045160326980834900334397492639583189210996397884942589307527272465344179155938112056419275364552206064201461462237744416724470640086722918524780890206023893535248274843719019319174705722911510807506933906382371748754819022430617415606426106834375637197806550831016627055105814918321017229359923792672743647391693743743146123885618196972610006428693421113080228906125510192850255877516140039461221
b_2= 11865578230563836828698440198808365763838529641027242368774648502528146025373884077636188559268558983553029345861005341892039509480861763747979370373285951032460886690599396504316564191297695866749350530719433597835530131842462394478691215454748422031274496715144914840581803915484205642237754397897135762963222557911979900760257412637291140293429425584155306979638319333273918692229160775503948430456548824596794763502666041465085282983358829082798254649239371165290718210100917096913199025417082399562485589742852045161633752465618786410930009837407350953986601362316013361870446096677995658906011118890837646662268
c_1= 4009779869087029255297463436169552204922655636486739641149158955611853474961823388440774560168088903319163374734746559193431012002310033134294928687790281560060480278406902405647710065437968470791144020214948251589802521673538106673520329593966117133035500642791160363872942530392478032603543815079749621272066298793745754177453129785264105576254533858055814555411033650580409676947102291490308738562451861962318065135790387510758132221037279295861267324464183809432424228112569670498250666299553720115811684942009389793137881124508986193925796993330600220816337487839592275984075100028603123399027888744446526336084
c_2= 9470532791192518339116567612452125668634254427593345077890928811136489095569332157070928187542877325732220962249094478185997114006520013646928161539356773555658138326485644749570751397752591877370804493367197391523565979494997776864514990972954373896156187161882821335142611778824885021617291630987368379239885737958813946409618414749366178178723492300258314121332637553715297423542857436720797021700415618429608435119251524740781833903275242120949797821323535018136881667998526942979724320776350568534803754580045582204197786249574712490746093947342307493799702810358608122422901511340954397692865671624257606048446
n_1= 12758089942147422526562581670640799437693626559720177948335448952480177040540092993839347305858716346620139258915118063052676763720502105839408081236315999453600215894689204755604040046196929147256570353306444785675709648665073725546856388899081456336370619470129424251159530163067693045543606732567681940633785188718453572053164778456198151034369543964342556284175816763267598187050376096124192024564750249854263088738800589356974410853869051058877431888385737390248624865065793387454497794541374321909982888533632248244348081428001135536261135254237936156340896691103352539883828862927723394248037465576852490432707
n_2= 12758089942147422526562581670640799437693626559720177948335448952480177040540092993839347305858716346620139258915118063052676763720502105839408081236315999453600215894689204755604040046196929147256570353306444785675709648665073725546856388899081456336370619470129424251159530163067693045543606732567681940633785188718453572053164778456198151034369543964342556284175816763267598187050376096124192024564750249854263088738800589356974410853869051058877431888385737390248624865065793387454497794541374321909982888533632248244348081428001135536261135254237936156340896691103352539883828862927723394248037465576852490432707
P.<x> = PolynomialRing(Zmod(n_1))

f1 = (a_1 * x + b_1)**e -c_1
f2 = (a_2 * x + b_2)**e -c_2

def gcd(a,b):
    while b:
        a, b = b, a % b
    return a.monic()


m = long_to_bytes(int(-gcd(f1, f2).coefficients()[0]))
print(m)
```
![image](https://hackmd.io/_uploads/H1CW9o8bR.png)
